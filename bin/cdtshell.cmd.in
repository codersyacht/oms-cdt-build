@ECHO OFF
@REM Licensed Materials - Property of IBM
@REM IBM Sterling Order Management (5725-D10), IBM Order Management (5737-D18)
@REM (C) Copyright IBM Corp. 2001, 2020 All Rights Reserved.
@REM US Government Users Restricted Rights - Use, duplication or disclosure restricted by GSA ADP Schedule Contract with IBM Corp.

setlocal

call &HOME_DIR_WIN;\bin\tmp.cmd

@REM Set the name of the source database that you have defined 
@REM in ${INSTALL_DIR}/resources/ydkprefs.xml
rem set SOURCE_DB=
@REM Specify the password required for the source database. This parameter is not
@REM required to be set if the source is an XML folder, unless that XML folder
@REM contains encrypted resources.
rem set SOURCE_PASSWORD=
@REM Set the name of the target database that you have defined 
@REM in ${INSTALL_DIR}/resources/ydkprefs.xml
rem set TARGET_DB=
@REM Specify the password required for the target database. This parameter is not
@REM required to be set if the target is an XML folder, unless that XML folder
@REM contains encrypted resources.
rem set TARGET_PASSWORD=

@REM Specify the password required to refresh the cache of the target database. This
@REM parameter is not required if there is no target cache to refresh.
rem set TARGET_HTTP_PASSWORD=

@REM Other options available to the ConfigDeployMain class:
@REM Set these options by modifying the script below. They cannot be passed as
@REM command line parameters.

@REM -MODE <mode>
@REM    The MODE may be one of several options to affect the type of operation.
@REM    Each mode has its own set of options.

@REM ----------------------------------------------
@REM -MODE Deploy [this is default]
@REM    Deploy changes from source to target database
@REM    There are several optional options available:
@REM -ExportDir <directory>
@REM    The given directory will be created, and the results of the comparison
@REM    will be written to it
@REM -ExportPassphrase <password>
@REM    The given password is used to encrypt supported Import/Export data when
@REM    exporting results. This is only applicable when ExportDir is given.
@REM -ImportDir <directory>
@REM    The given directory should contain an export. Rather than compare the
@REM    source and target databases, this export will be loaded. When this
@REM    argument is present, the Source database properties are not used.
@REM -ImportPassphrase <password>
@REM    The given password is used to decrypt data from the import files as
@REM    needed, and should match the password given to create the export.
@REM -DoNotSynchronize <Y|N>
@REM    If passed as Y, only the comparison will take place; nothing will be
@REM    deployed. By default, results are automatically deployed.
@REM -ColonyId <ColonyId>
@REM    ColonyId to filter data with when in a multi-schema environment. By
@REM    default, all data in the affected tables will be processed.
@REM -Compare<Type> <CompareValue>
@REM    Filter results by the given CompareValue, as defined in the config-db.xml.
@REM    If the option is not given, the corresponding filter will not be used.
@REM    Consult the product documentation for all supported options.
@REM -AppendOnly <Y|N>
@REM    Pass Y to treat all tables as if they were configured to be Append-Only
@REM    within the CDT preferences.
@REM -IgnoreMissingTables <Y|N>
@REM    Pass Y to ignore tables that are missing in the source or target databases.
@REM -LabelId <LabelId>
@REM    The given value will be used to create labels BEGIN_<LabelId> and
@REM    END_<LabelId> before and after the deployment, respectively. If the option
@REM    is not given, no labels will be created.
@REM -ShowAbandoned <Y|N>
@REM    Pass Y to not ignore Abandoned records


@REM  ----------------------------------------------
@REM  -MODE LABELDEPLOY
@REM     Deploy audit changes between two version labels.
@REM     There are two available options:
@REM  -FromLabel <LabelID to start from>
@REM  -ToLabel <LabelID to end with>

set dstamp=%DATE:~-4%.%DATE:~-7,-5%.%DATE:~-10,-8%_%time:~0,2%.%time:~3,2%.%time:~6,5%
set LOG_FILE=&LOG_DIR;\cdtshell.%dstamp%.log

set CLASSPATH=&HOME_DIR_WIN;\jar\bootstrapper.jar;&INSTALL_DIR;\resources\ydkresources

%JAVA%  %HEAP_FLAGS% %LOG_FLAGS% -DDISABLE_DS_EXTENSIONS=Y -DDISABLE_EXTENSIONS=Y -DYFS_HOME=&HOME_DIR_WIN; -classpath %CLASSPATH% -Dvendor=shell -DvendorFile=&HOME_DIR_WIN;/properties/servers.properties -DUseEntitiesFromClasspath=Y com.sterlingcommerce.woodstock.noapp.NoAppLoader -class com.yantra.tools.ydk.config.ConfigDeployMain -f &HOME_DIR_WIN;/properties/dynamicclasspath.cfg -invokeargs -Source %SOURCE_DB% -Target %TARGET_DB% -SourcePassword %SOURCE_PASSWORD% -TargetPassword %TARGET_PASSWORD% -TargetHTTPPassword %TARGET_HTTP_PASSWORD% %* 2>&1 | &BIN_DIR_WIN;\tee %LOG_FILE%

goto END

:ERROREXIT
exit /B -1

:END
endlocal
